!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;((e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pip||(e.pip={})).dashboard=t()}}(function(){return function l(s,r,a){function p(e,t){if(!r[e]){if(!s[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(c)return c(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var n=r[e]={exports:{}};s[e][0].call(n.exports,function(t){return p(s[e][1][t]||t)},n,n.exports,l,s,r,a)}return r[e].exports}for(var c="function"==typeof require&&require,t=0;t<a.length;t++)p(a[t]);return p}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function o(){}i.AddTileDialog=o;var n=(l.prototype.add=function(){this.$mdDialog.hide({groupIndex:this.activeGroupIndex,widgets:this.defaultTiles})},l.prototype.cancel=function(){this.$mdDialog.cancel()},l.prototype.encrease=function(t,e){this.defaultTiles[t][e].amount++,this.totalTiles++},l.prototype.decrease=function(t,e){var i=this.defaultTiles[t][e];i.amount=i.amount?i.amount-1:0,this.totalTiles=this.totalTiles?this.totalTiles-1:0},l);function l(t,e,i,o){this.activeGroupIndex=e,this.$mdDialog=o,this.totalTiles=0,this.activeGroupIndex=_.isNumber(e)?e:-1,this.defaultTiles=_.cloneDeep(i),this.groups=_.map(t,function(t){return t.title})}i.AddTileDialogController=n},{}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function o(t){var e=t.has("pipTranslateProvider")?t.get("pipTranslateProvider"):null;e&&(e.setTranslations("en",{DASHBOARD_ADD_TILE_DIALOG_TITLE:"Add component",DASHBOARD_ADD_TILE_DIALOG_USE_HOT_KEYS:'Use "Enter" or "+" buttons on keyboard to encrease and "Delete" or "-" to decrease tiles amount',DASHBOARD_ADD_TILE_DIALOG_CREATE_NEW_GROUP:"Create new group"}),e.setTranslations("ru",{DASHBOARD_ADD_TILE_DIALOG_TITLE:"Добавить компонент",DASHBOARD_ADD_TILE_DIALOG_USE_HOT_KEYS:'Используйте "Enter" или "+" клавиши на клавиатуре чтобы увеличить и "Delete" or "-" чтобы уменшить количество тайлов',DASHBOARD_ADD_TILE_DIALOG_CREATE_NEW_GROUP:"Создать новую группу"}))}var n=t("./AddTileDialogController");o.$inject=["$injector"];var l=(a.prototype.show=function(t,e){var i=this;return this.$mdDialog.show({templateUrl:"add_tile_dialog/AddTile.html",bindToController:!0,controller:n.AddTileDialogController,controllerAs:"dialogCtrl",clickOutsideToClose:!0,resolve:{groups:function(){return t},activeGroupIndex:function(){return e},widgetList:function(){return i.widgetList}}})},a),s=(r.prototype.$get=["$mdDialog",function(t){return null==this._service&&(this._service=new l(this._tilesList,t)),this._service}],r);function r(){this._tilesList=null,this.configTilesList=function(t){this._tilesList=t}}function a(t,e){this.widgetList=t,this.$mdDialog=e}angular.module("pipAddDashboardTileDialog").config(o).provider("pipAddTileDialog",s)},{"./AddTileDialogController":1}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipAddDashboardTileDialog",["ngMaterial"]),t("./AddTileDialogController"),t("./AddTileProvider")},{"./AddTileDialogController":1,"./AddTileProvider":2}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=(n.prototype.changeSize=function(t){this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY},n);function n(){var t=this;this.menu=[{title:"Change Size",action:angular.noop,submenu:[{title:"1 x 1",action:function(){t.changeSize({sizeX:1,sizeY:1})},params:{sizeX:1,sizeY:1}},{title:"2 x 1",action:"changeSize",params:{sizeX:2,sizeY:1}},{title:"2 x 2",action:"changeSize",params:{sizeX:2,sizeY:2}}]}]}i.DashboardTile=o},{}],5:[function(t,e,i){angular.module("pipDashboard").directive("pipDynamicTile",["$templateRequest","$compile","$interpolate",function(l,s,t){return{restrict:"E",scope:{options:"=pipOptions"},templateUrl:"common_tile/DynamicTile.html",controller:"@",name:"controller",controllerAs:"$ctrl",bindToController:!0,link:function(i,e,t){var o=[{title:"Change Size",action:angular.noop,submenu:[{title:"1 x 1",action:function(){n(1,1)},params:{sizeX:1,sizeY:1}},{title:"2 x 1",action:function(){n(2,1)},params:{sizeX:2,sizeY:1}},{title:"2 x 2",action:function(){n(2,2)},params:{sizeX:2,sizeY:2}}]}];function n(t,e){i.$ctrl.options.size.colSpan=t,i.$ctrl.options.size.rowSpan=e}angular.extend(i.$ctrl.options.menu,o),angular.isDefined(t.controllerAs)&&t.controllerAs&&(i[t.controllerAs]=i.$ctrl),angular.isDefined(t.template)&&l(t.template).then(function(t){e.find("pip-specific-template").replaceWith(s(t)(i))})}}}])},{}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){};n.all=["purple","green","gray","orange","blue"];var l=function(){};l.all=[{name:"DASHBOARD_TILE_CONFIG_DIALOG_SIZE_SMALL",id:"11"},{name:"DASHBOARD_TILE_CONFIG_DIALOG_SIZE_WIDE",id:"21"},{name:"DASHBOARD_TILE_CONFIG_DIALOG_SIZE_LARGE",id:"22"}];var o=(s.$inject=["params","extensionUrl","$mdDialog"],s.prototype.onApply=function(t){this.size.sizeX=Number(this.sizeId.substr(0,1)),this.size.sizeY=Number(this.sizeId.substr(1,1)),this.$mdDialog.hide(t)},s);function s(t,e,i){var o=this;this.params=t,this.extensionUrl=e,this.$mdDialog=i,this.colors=n.all,this.sizes=l.all,this.sizeId=l.all[0].id,angular.extend(this,this.params),this.sizeId=""+this.params.size.colSpan+this.params.size.rowSpan,this.onCancel=function(){o.$mdDialog.cancel()}}i.TileConfigDialogController=o},{}],7:[function(t,e,i){var o={templateUrl:"config_tile_dialog/ConfigDialogExtendComponent.html",controller:(n.prototype.$onChanges=function(t){var e=this;t.pipDialogScope&&(delete t.pipDialogScope.currentValue.$scope,angular.extend(this,t.pipDialogScope.currentValue)),t.pipExtensionUrl&&t.pipExtensionUrl.currentValue&&this.$templateRequest(t.pipExtensionUrl.currentValue,!1).then(function(t){e.$element.find("pip-extension-point").replaceWith(e.$compile(t)(e.$scope))})},n.prototype.onApply=function(){this.pipApply({updatedData:this})},n),bindings:{pipExtensionUrl:"<",pipDialogScope:"<",pipApply:"&"}};function n(t,e,i,o,n){this.$templateRequest=t,this.$compile=e,this.$scope=i,this.$element=o,this.$attrs=n}angular.module("pipConfigDashboardTileDialog").component("pipTileConfigExtendComponent",o)},{}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function o(t){var e=t.has("pipTranslateProvider")?t.get("pipTranslateProvider"):null;e&&(e.setTranslations("en",{DASHBOARD_TILE_CONFIG_DIALOG_TITLE:"Edit tile",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_SMALL:"Small",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_WIDE:"Wide",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_LARGE:"Large"}),e.setTranslations("ru",{DASHBOARD_TILE_CONFIG_DIALOG_TITLE:"Изменить виджет",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_SMALL:"Мален.",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_WIDE:"Широкий",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_LARGE:"Большой"}))}var n=t("./ConfigDialogController");o.$inject=["$injector"];var l=(s.$inject=["$mdDialog"],s.prototype.show=function(t,e,i){this.$mdDialog.show({targetEvent:t.event,templateUrl:t.templateUrl||"config_tile_dialog/ConfigDialog.html",controller:n.TileConfigDialogController,bindToController:!0,controllerAs:"vm",locals:{extensionUrl:t.extensionUrl,params:t.locals},clickOutsideToClose:!0}).then(function(t){e&&e(t)},function(){i&&i()})},s);function s(t){this.$mdDialog=t}angular.module("pipConfigDashboardTileDialog").config(o).service("pipTileConfigDialogService",l)},{"./ConfigDialogController":6}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipConfigDashboardTileDialog",["ngMaterial"]),t("./ConfigDialogController"),t("./ConfigDialogService"),t("./ConfigDialogExtendComponent")},{"./ConfigDialogController":6,"./ConfigDialogExtendComponent":7,"./ConfigDialogService":8}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function o(t){var e=t.has("pipTranslateProvider")?t.get("pipTranslateProvider"):null;e&&(e.setTranslations("en",{DROP_TO_CREATE_NEW_GROUP:"Drop here to create new group"}),e.setTranslations("ru",{DROP_TO_CREATE_NEW_GROUP:"Перетащите сюда для создания новой группы"}))}o.$inject=["$injector"];function n(t){t.configTilesList([[{title:"Event",icon:"document",name:"event",amount:0},{title:"Position",icon:"location",name:"position",amount:0}],[{title:"Calendar",icon:"date",name:"calendar",amount:0},{title:"Sticky Notes",icon:"note-take",name:"notes",amount:0},{title:"Statistics",icon:"tr-statistics",name:"statistics",amount:0}]])}var c={tileWidth:150,tileHeight:150,gutter:10,inline:!(n.$inject=["pipAddTileDialogProvider"])},l={bindings:{gridOptions:"=pipGridOptions",groupAdditionalActions:"=pipGroupActions",groupedWidgets:"=pipGroups"},controller:(s.prototype.compileWidgets=function(){var n=this;_.each(this.groupedWidgets,function(t,o){t.removedWidgets=t.removedWidgets||[],t.source=t.source.map(function(t,e){var i;return t.size=t.size||{colSpan:1,rowSpan:1},t.index=e,t.groupIndex=o,t.menu=t.menu||[],(i=n.pipDashboard.getTypeByName(t.type))&&(t.ctrl=i.controller,t.tmpl=i.templateUrl||i.template,t.ctrlAs=i.controllerAs,t.class=i.class),angular.extend(t.menu,[{title:"Remove",click:function(t,e,i){n.removeWidget(t,e,i)}}]),{opts:t.opts||t,template:n.pipTileTemplate.getTemplate(t,n._dynamicTileTpl)}})})},s.prototype.addComponent=function(t){var i=this;this.pipAddTileDialog.show(this.groupedWidgets,t).then(function(t){var e;t&&(e=-1!==t.groupIndex?i.groupedWidgets[t.groupIndex]:{title:"New group",source:[]},i.addWidgets(e.source,t.widgets),-1===t.groupIndex&&i.groupedWidgets.push(e),i.compileWidgets())})},s.prototype.addWidgets=function(e,t){t.forEach(function(t){t.forEach(function(t){t.amount&&Array.apply(null,Array(t.amount)).forEach(function(){e.push({type:t.name})})})})},s.prototype.removeWidget=function(t,e,i){var o=this;this.groupedWidgets[e.options.groupIndex].removedWidgets=[],this.groupedWidgets[e.options.groupIndex].removedWidgets.push(e.options.index),this.groupedWidgets[e.options.groupIndex].source.splice(e.options.index,1),this.$timeout(function(){o.groupedWidgets[e.options.groupIndex].removedWidgets=[]})},s),templateUrl:"dashboard/Dashboard.html"};function s(t,e,i,o,n,l,s,r,a){var p=this;this.$rootScope=e,this.$attrs=i,this.$element=o,this.$timeout=n,this.$interpolate=l,this.pipAddTileDialog=s,this.pipTileTemplate=r,this.pipDashboard=a,this.defaultGroupMenuActions=[{title:"Add Component",callback:function(t){p.addComponent(t)}},{title:"Remove",callback:function(t){p.removeGroup(t)}},{title:"Configurate",callback:function(t){console.log("configurate group with index:",t)}}],this._includeTpl='<pip-{{ type }}-tile group="groupIndex" index="index"pip-options="$parent.$ctrl.groupedWidgets[groupIndex][\'source\'][index].opts"></pip-{{ type }}-tile>',this._dynamicTileTpl='<pip-dynamic-tile controller="{{ ctrl }}" template="{{ tmpl }}" class="{{ class }}" controller-as="{{ ctrlAs }}" pip-options="$parent.$ctrl.groupedWidgets[groupIndex][\'source\'][index].opts"></pip-dynamic-tile>',this.groupMenuActions=this.defaultGroupMenuActions,this.removeGroup=function(t){p.groupedWidgets.splice(t,1)},o.addClass("pip-scroll"),this.draggableGridOptions=this.gridOptions||c,!0===this.draggableGridOptions.inline&&o.addClass("inline-grid"),this.groupAdditionalActions&&angular.extend(this.groupMenuActions,this.groupAdditionalActions),this.widgetsContext=t,this.compileWidgets(),this.$timeout(function(){p.$element.addClass("visible")},700)}angular.module("pipDashboard").config(n).config(o).component("pipDashboard",l)},{}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var p=t("./DraggableTileService"),l=t("../tile_group/TileGroupService");i.DEFAULT_TILE_WIDTH=150,i.DEFAULT_TILE_HEIGHT=150,i.UPDATE_GROUPS_EVENT="pipUpdateDashboardGroupsConfig";var c={tileWidth:i.DEFAULT_TILE_WIDTH,tileHeight:i.DEFAULT_TILE_HEIGHT,gutter:0,container:"pip-draggable-grid:first-of-type",activeDropzoneClass:"dropzone-active",groupContaninerSelector:".pip-draggable-group:not(.fict-group)"},o={bindings:{tilesTemplates:"=pipTilesTemplates",tilesContext:"=pipTilesContext",options:"=pipDraggableGrid",groupMenuActions:"=pipGroupMenuActions"},templateUrl:"draggable/Draggable.html",controller:(n.prototype.$postLink=function(){this.$container=this.$element},n.prototype.watch=function(t){var e=this,i=this.groups,o=null;if(t.length>i.length)this.addGroup(t[t.length-1]);else if(t.length<i.length)this.removeGroups(t);else{for(var n=0;n<t.length;n++){var l=i[n].source.length-t[n].source.length;if(l||t[n].removedWidgets&&0<t[n].removedWidgets.length){if(o=n,l<0){var s=t[o].source.slice(l);_.each(s,function(t){console.log("tile",t)}),this.addTilesIntoGroup(s,this.tileGroups[o],this.groupsContainers[o]),this.$timeout(function(){e.updateTilesGroups()})}else this.removeTiles(this.tileGroups[o],t[o].removedWidgets,this.groupsContainers[o]),this.updateTilesOptions(t),this.$timeout(function(){e.updateTilesGroups()});return}}t&&this.tileGroups&&(this.updateTilesOptions(t),this.$timeout(function(){e.updateTilesGroups()}))}},n.prototype.onTitleClick=function(t,e){t.editingName||(t.oldTitle=_.clone(t.title),t.editingName=!0,this.$timeout(function(){$(e.currentTarget.children[0]).focus()}))},n.prototype.cancelEditing=function(t){t.title=t.oldTitle},n.prototype.onBlurTitleInput=function(t){var e=this;this.$timeout(function(){t.editingName=!1,e.$rootScope.$broadcast(i.UPDATE_GROUPS_EVENT,e.groups),e.tilesTemplates[t.index].title=t.title},100)},n.prototype.onKyepressTitleInput=function(t,e){13===e.keyCode&&this.onBlurTitleInput(t)},n.prototype.updateTilesTemplates=function(t,e){switch(t){case"addGroup":this.groups.length!==this.tilesTemplates.length&&this.tilesTemplates.push(e);break;case"moveTile":var i={fromIndex:e.from.elem.attributes["data-group-id"].value,toIndex:e.to.elem.attributes["data-group-id"].value,tileOptions:e.tile.opts.options,fromTileIndex:e.tile.opts.options.index},o=i.fromIndex,n=i.toIndex,l=i.tileOptions,s=i.fromTileIndex;this.tilesTemplates[o].source.splice(s,1),this.tilesTemplates[n].source.push({opts:l}),this.reIndexTiles(e.from.elem),this.reIndexTiles(e.to.elem)}},n.prototype.createTileScope=function(t){var e=this.$rootScope.$new(!1,this.tilesContext);return e.index=null==t.opts.index?t.opts.options.index:t.opts.index,e.groupIndex=null==t.opts.groupIndex?t.opts.options.groupIndex:t.opts.groupIndex,e},n.prototype.removeTiles=function(e,t,i){var o=$(i).find(".pip-draggable-tile");_.each(t,function(t){e.tiles.splice(t,1),o[t].remove()}),this.reIndexTiles(i)},n.prototype.reIndexTiles=function(t,e){var i=$(t).find(".pip-draggable-tile"),o=void 0===e?t.attributes["data-group-id"].value:e;_.each(i,function(t,e){var i=$(t).children()[0];angular.element(i).scope().index=e,angular.element(i).scope().groupIndex=o})},n.prototype.removeGroups=function(i){var o=this,n=[],l=[],e=[];_.each(this.groups,function(e,t){_.findIndex(i,function(t){return t.title===e.title})<0?n.push(t):l.push(t)}),_.each(n.reverse(),function(t){o.groups.splice(t,1),o.tileGroups.splice(t,1)}),_.each(l,function(t){e.push(o.groupsContainers[t])}),this.groupsContainers=e,_.each(this.groupsContainers,function(t,e){o.reIndexTiles(t,e)})},n.prototype.addGroup=function(t,e){var i=this;void 0===e&&(e=!1);var o={title:t.title,source:t.source.map(function(t){var e=i.createTileScope(t);return p.IDragTileConstructor(p.DragTileService,{tpl:i.$compile(i.wrapComponent(t.template))(e),options:t.opts,size:t.opts.size})})};this.groups.push(o),e&&!this.$scope.$$phase&&this.$scope.$apply(),this.$timeout(function(){i.groupsContainers=document.querySelectorAll(i.opts.groupContaninerSelector),i.tileGroups.push(l.ITilesGridConstructor(l.TilesGridService,o.source,i.opts,i.availableColumns,i.groupsContainers[i.groupsContainers.length-1]).generateGrid(i.getSingleTileWidthForMobile(i.availableWidth)).setTilesDimensions().calcContainerHeight())}),this.updateTilesTemplates("addGroup",t)},n.prototype.wrapComponent=function(t){return $("<div>").addClass("pip-draggable-tile").attr("pip-drag","true").attr("pip-scroll-container","'.pip-dashboard-scroll'").append(t).get(0)},n.prototype.addTilesIntoGroup=function(t,o,n){var l=this;t.forEach(function(t){var e=l.createTileScope(t),i=p.IDragTileConstructor(p.DragTileService,{tpl:l.$compile(l.wrapComponent(t.template))(e),options:t.opts,size:t.opts.size});o.addTile(i),$(i.getCompiledTemplate()).appendTo(n)})},n.prototype.updateTilesOptions=function(t){var i=this;t.forEach(function(t){t.source.forEach(function(e){i.tileGroups.forEach(function(t){t.updateTileOptions(e.opts)})})})},n.prototype.initTilesGroups=function(t,i,o){var n=this;return t.map(function(t,e){return l.ITilesGridConstructor(l.TilesGridService,t.source,i,n.availableColumns,o[e]).generateGrid(n.getSingleTileWidthForMobile(n.availableWidth)).setTilesDimensions().calcContainerHeight()})},n.prototype.updateTilesGroups=function(e,i){var o=this;this.tileGroups.forEach(function(t){e||t.generateGrid(o.getSingleTileWidthForMobile(o.availableWidth)),t.setTilesDimensions(e,i).calcContainerHeight(o.options.tileHeight)})},n.prototype.getContainerWidth=function(){return(this.$container||$("body")).width()},n.prototype.getAvailableColumns=function(t){return this.opts.mobileBreakpoint>t?2:Math.floor(t/(this.opts.tileWidth+this.opts.gutter))},n.prototype.getActiveGroupAndTile=function(i){var o={};return this.tileGroups.forEach(function(t){var e=t.getTileByNode(i);if(e)return o.group=t,void(o.tile=e)}),o},n.prototype.getSingleTileWidthForMobile=function(t){return console.log("gut",this.opts.gutter),this.opts.mobileBreakpoint>t?t/2-this.opts.gutter:null},n.prototype.onDragStartListener=function(t){if(t.x){console.log("drag start"),t.target=t.element.get(0);var e=this.getActiveGroupAndTile(t.target);this.container=$(t.target).parent(".pip-draggable-group").get(0),this.sourceDropZoneElem=this.container,this.draggedTile=e.tile,this.activeDraggedGroup=e.group,console.log("activeDraggedGroup",this.activeDraggedGroup),this.$element.addClass("drag-transfer"),this.draggedTile.startDrag()}},n.prototype.onDragMoveListener=function(t){var e=this;t.element.get(0),console.log("drag move"),this.containerOffset=this.getContainerOffset();var i=this.activeDraggedGroup.getTileByCoordinates({left:t.x-this.containerOffset.left,top:t.y-this.containerOffset.top},this.draggedTile);if(i){if(this.activeDraggedGroup.getTileIndex(this.draggedTile)+1===this.activeDraggedGroup.getTileIndex(i))return;this.activeDraggedGroup.swapTiles(this.draggedTile,i).setTilesDimensions(!0,this.draggedTile),this.$timeout(function(){e.setGroupContainersHeight()},0)}},n.prototype.onDragEndListener=function(){this.draggedTile&&(console.log("drag end"),this.draggedTile.stopDrag(!1),this.$element.removeClass("drag-transfer"))},n.prototype.getContainerOffset=function(){var t=this.container.getBoundingClientRect();return{left:t.left,top:t.top}},n.prototype.setGroupContainersHeight=function(){this.tileGroups.forEach(function(t){t.calcContainerHeight()})},n.prototype.moveTile=function(t,e,i){var o,n=t.removeTile(i),l=this.createTileScope(i);$(this.groupsContainers[_.findIndex(this.tileGroups,t)]).find(n.getElem()).remove(),null!==e&&(e.addTile(n),o=this.$compile(n.getElem())(l),$(this.groupsContainers[_.findIndex(this.tileGroups,e)]).append(o),this.$timeout(e.setTilesDimensions.bind(e,!0))),this.updateTilesTemplates("moveTile",{from:t,to:e,tile:n})},n.prototype.onDropListener=function(t,e){if(this.draggedTile){var i=this.tileGroups[t];this.activeDraggedGroup!==i&&this.moveTile(this.activeDraggedGroup,i,this.draggedTile),this.groupsContainers[t].classList.remove(this.opts.activeDropzoneClass),$("body").css("cursor",""),this.updateTilesGroups(!0),this.sourceDropZoneElem=null,this.activeDraggedGroup=null,this.draggedTile=null}},n.prototype.onDropToFictGroupListener=function(t){var e=this,i=this.activeDraggedGroup,o=this.draggedTile;this.addGroup({title:"New group",source:[]},!0),this.$timeout(function(){e.moveTile(i,e.tileGroups[e.tileGroups.length-1],o),e.updateTilesGroups(!0)}),$("body").css("cursor",""),this.sourceDropZoneElem=null,this.activeDraggedGroup=null,this.draggedTile=null},n.prototype.onDropEnterListener=function(t,e){this.sourceDropZoneElem||(this.sourceDropZoneElem=this.groupsContainers[t]),console.log("sourceDropZoneElem",this.sourceDropZoneElem),null!==t&&this.sourceDropZoneElem!==this.groupsContainers[t]?(this.groupsContainers[t].classList.add("dropzone-active"),$("body").css("cursor","copy"),this.isSameDropzone=!1):($("body").css("cursor",""),this.isSameDropzone=!0)},n.prototype.onDropDeactivateListener=function(t,e){this.sourceDropZoneElem!==e.target&&null!==t&&(this.groupsContainers[t].classList.remove(this.opts.activeDropzoneClass),$("body").css("cursor",""))},n.prototype.onDropLeaveListener=function(t,e){null!==t&&this.groupsContainers[t].classList.remove(this.opts.activeDropzoneClass)},n.prototype.initialize=function(){var t=this;this.$timeout(function(){t.availableWidth=t.getContainerWidth(),t.availableColumns=t.getAvailableColumns(t.availableWidth),t.groupsContainers=document.querySelectorAll(t.opts.groupContaninerSelector),t.tileGroups=t.initTilesGroups(t.groups,t.opts,t.groupsContainers)},0)},n)};function n(t,e,i,o,n,l,s,r){var a=this;this.$scope=t,this.$rootScope=e,this.$compile=i,this.$timeout=o,this.$element=n,this.sourceDropZoneElem=null,this.isSameDropzone=!0,this.tileGroups=null,this.opts=_.merge({mobileBreakpoint:r.breakpoints.xs},c,this.options),console.log("this.options",this.options),console.log("this.opts",this.opts),this.groups=this.tilesTemplates.map(function(t,e){return{title:t.title,editingName:!1,index:e,source:t.source.map(function(t){var e=a.createTileScope(t);return p.IDragTileConstructor(p.DragTileService,{tpl:i(t.template)(e),options:t.opts,size:t.opts.size})})}}),t.$watch("$ctrl.tilesTemplates",function(t){a.watch(t)},!0),this.initialize(),$(window).on("resize",_.debounce(function(){a.availableWidth=a.getContainerWidth(),a.availableColumns=a.getAvailableColumns(a.availableWidth),a.tileGroups.forEach(function(t){t.setAvailableColumns(a.availableColumns).generateGrid(a.getSingleTileWidthForMobile(a.availableWidth)).setTilesDimensions().calcContainerHeight()})},50)),this.$rootScope.$on("draggable:start",function(t,e){a.onDragStartListener(e)}),this.$rootScope.$on("draggable:move",function(t,e){a.onDragMoveListener(e)}),this.$rootScope.$on("draggable:end",function(t,e){a.onDragEndListener()})}angular.module("pipDraggableTiles").component("pipDraggableGrid",o)},{"../tile_group/TileGroupService":23,"./DraggableTileService":12}],12:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.IDragTileConstructor=function(t,e){return new t(e)};var o={colSpan:1,rowSpan:1},n=(l.prototype.getSize=function(){return this.size},l.prototype.setSize=function(t,e){return this.size.width=t,this.size.height=e,this.elem&&this.elem.css({width:t,height:e}),this},l.prototype.setPosition=function(t,e){return this.size.left=t,this.size.top=e,this.elem&&this.elem.css({left:t,top:e}),this},l.prototype.getCompiledTemplate=function(){return this.tpl},l.prototype.updateElem=function(t){return this.elem=$(this.tpl).parent(t),this},l.prototype.getElem=function(){return this.elem.get(0)},l.prototype.startDrag=function(){return this.preview=$("<div>").addClass("pip-dragged-preview").css({position:"absolute",left:this.elem.css("left"),top:this.elem.css("top"),width:this.elem.css("width"),height:this.elem.css("height")}),this.elem.addClass("no-animation").css({zIndex:"9999"}).after(this.preview),this},l.prototype.stopDrag=function(t){if(this.preview){var e=this;return t?e.elem.removeClass("no-animation").css({left:e.preview.css("left"),top:e.preview.css("top")}).on("transitionend",function(){i()}):(e.elem.css({left:e.preview.css("left"),top:e.preview.css("top"),zIndex:""}).removeClass("no-animation"),e.preview.remove(),e.preview=null),this}function i(){e.preview&&(e.preview.remove(),e.preview=null),e.elem&&e.elem.css("zIndex","").off("transitionend",i)}},l.prototype.setPreviewPosition=function(t){this.preview.css(t)},l.prototype.getOptions=function(){return this.opts.options},l.prototype.setOptions=function(t){return _.merge(this.opts.options,t),_.merge(this.size,t.size),this},l);function l(t){this.tpl=t.tpl.get(0),this.opts=t,this.size=_.merge({},o,t.size),this.elem=null}i.DragTileService=n,angular.module("pipDraggableTiles").service("pipDragTile",function(){return function(t){return new n(t)}})},{}],13:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipDraggableTiles",[]),t("./DraggableTileService"),t("./Draggable")},{"./Draggable":11,"./DraggableTileService":12}],14:[function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});function l(t){t.registerTileType(a)}var s,r=t("../common_tile/DashboardTile"),a={name:"event",controllerAs:"$ctrl",class:"pip-event-tile",controller:(s=r.DashboardTile,n(p,s),p.prototype.drawImage=function(){var t=this;this.options.image&&this.$timeout(function(){t.onImageLoad(t.$element.find("img"))},500)},p.prototype.onConfigClick=function(){var e=this;this._oldOpacity=_.clone(this.opacity),this.pipTileConfigDialogService.show({dialogClass:"pip-calendar-config",locals:{color:this.color,size:this.options.size||{colSpan:1,rowSpan:1},date:this.options.date,title:this.options.title,text:this.options.text,opacity:this.opacity,onOpacitytest:function(t){e.opacity=t}},extensionUrl:"event_tile/ConfigDialogExtension.html"},function(t){e.changeSize(t.size),e.color=t.color,e.options.color=t.color,e.options.date=t.date,e.options.title=t.title,e.options.text=t.text,e.options.opacity=t.opacity},function(){e.opacity=e._oldOpacity})},p.prototype.onImageLoad=function(t){this.setImageMarginCSS(this.$element.parent(),t)},p.prototype.changeSize=function(t){var e=this;this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.options.image&&this.$timeout(function(){e.setImageMarginCSS(e.$element.parent(),e.$element.find("img"))},500)},p.prototype.setImageMarginCSS=function(t,e){var i=t.width?t.width():t.clientWidth,o=t.height?t.height():t.clientHeight,n=e[0].naturalWidth||e.width,l=e[0].naturalHeight||e.height,s=0,r={};l/o<n/i?(s=-(n/l*o-i)/2,r["margin-left"]=s+"px",r.height=o+"px",r.width=n*o/l+"px",r["margin-top"]=""):(s=-(l/n*i-o)/2,r["margin-top"]=s+"px",r.height=l*i/n+"px",r.width=i+"px",r["margin-left"]=""),e.css(r)},p),templateUrl:"event_tile/EventTile.html"};function p(t,e,i,o){var n=s.call(this)||this;return n.$element=e,n.$timeout=i,n.pipTileConfigDialogService=o,n.opacity=.57,n.options.menu.push({title:"Configurate",action:function(){n.onConfigClick()}}),n.color=n.options.color||"gray",n.opacity=n.options.opacity||n.opacity,n.drawImage(),t.$watch(function(){return e.is(":visible")},function(t){n.drawImage()}),n}l.$inject=["pipDashboardProvider"],angular.module("pipDashboard").config(l)},{"../common_tile/DashboardTile":4}],15:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),t("./tile_group/index"),t("./draggable"),t("./menu_tile"),t("./add_tile_dialog"),t("./config_tile_dialog"),angular.module("pipDashboard",["pipDraggableTiles","pipDraggableTilesGroup","pipMenuTile","pipConfigDashboardTileDialog","pipAddDashboardTileDialog","pipDashboard.Templates","pipLayout","pipLocations","pipDate","pipCharts","pipTranslate","pipControls","pipButtons","pipBehaviors"]),t("./utility/TileTemplateUtility"),t("./utility/DashboardService"),t("./common_tile/DashboardTile"),t("./common_tile/DynamicTile"),t("./event_tile/EventTile"),t("./note_tile/NoteTile"),t("./picture_slider_tile/PictureSliderTile"),t("./position_tile/PositionTile"),t("./statistics_tile/StatisticsTile"),t("./dashboard/Dashboard")},{"./add_tile_dialog":3,"./common_tile/DashboardTile":4,"./common_tile/DynamicTile":5,"./config_tile_dialog":9,"./dashboard/Dashboard":10,"./draggable":13,"./event_tile/EventTile":14,"./menu_tile":17,"./note_tile/NoteTile":18,"./picture_slider_tile/PictureSliderTile":19,"./position_tile/PositionTile":20,"./statistics_tile/StatisticsTile":21,"./tile_group/index":24,"./utility/DashboardService":25,"./utility/TileTemplateUtility":26}],16:[function(t,e,i){angular.module("pipMenuTile").component("pipTileMenu",{templateUrl:"menu_tile/MenuTile.html",bindings:{menu:"<pipMenu"}})},{}],17:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipMenuTile",[]),t("./MenuTileDirective")},{"./MenuTileDirective":16}],18:[function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});function l(t){t.registerTileType(a)}var s,r=t("../common_tile/DashboardTile"),a={name:"note",controller:(s=r.DashboardTile,n(p,s),p.prototype.onConfigClick=function(){var e=this;this.pipTileConfigDialogService.show({locals:{color:this.color,size:this.options.size,title:this.options.title,text:this.options.text},extensionUrl:"note_tile/ConfigDialogExtension.html"},function(t){e.color=t.color,e.options.color=t.color,e.changeSize(t.size),e.options.text=t.text,e.options.title=t.title})},p),controllerAs:"$ctrl",class:"pip-notes-tile",templateUrl:"note_tile/NoteTile.html"};function p(t,e){var i=s.call(this)||this;return i.pipTileConfigDialogService=t,i.options.menu.push({title:"Configurate",action:function(){i.onConfigClick()}}),i.color=i.options.color||"orange",i}l.$inject=["pipDashboardProvider"],angular.module("pipDashboard").config(l)},{"../common_tile/DashboardTile":4}],19:[function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});function l(t){t.registerTileType(a)}var s,r=t("../common_tile/DashboardTile"),a={name:"picture-slider",controller:(s=r.DashboardTile,n(p,s),p.prototype.onImageLoad=function(t){var e=this;this.$timeout(function(){e.pipTileTemplate.setImageMarginCSS(e.$element.parent(),t.target)})},p.prototype.changeSize=function(t){var e=this;this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.$timeout(function(){_.each(e.$element.find("img"),function(t){e.pipTileTemplate.setImageMarginCSS(e.$element.parent(),t)})},500)},p),controllerAs:"$ctrl",class:"pip-picture-slider-tile",templateUrl:"picture_slider_tile/PictureSliderTile.html"};function p(t,e,i,o){var n=s.call(this)||this;return n.$scope=t,n.$element=e,n.$timeout=i,n.pipTileTemplate=o,n.animationType="fading",n.animationInterval=5e3,n.options&&(n.animationType=n.options.animationType||n.animationType,n.animationInterval=n.options.animationInterval||n.animationInterval),n}l.$inject=["pipDashboardProvider"],angular.module("pipDashboard").config(l)},{"../common_tile/DashboardTile":4}],20:[function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});function l(t){t.registerTileType(a)}var s,r=t("../common_tile/DashboardTile"),a={name:"position",class:"pip-position-tile",controllerAs:"$ctrl",controller:(s=r.DashboardTile,n(p,s),p.prototype.onConfigClick=function(){var e=this;this.pipTileConfigDialogService.show({dialogClass:"pip-position-config",locals:{size:this.options.size,locationName:this.options.locationName,hideColors:!0},extensionUrl:"position_tile/ConfigDialogExtension.html"},function(t){e.changeSize(t.size),e.options.locationName=t.locationName})},p.prototype.changeSize=function(t){this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.reDrawPosition()},p.prototype.openLocationEditDialog=function(){var e=this;this.pipLocationEditDialog.show({locationName:this.options.locationName,locationPos:this.options.location},function(t){t&&(e.options.location=t.location,e.options.locationName=t.locatioName)})},p.prototype.reDrawPosition=function(){var t=this;this.showPosition=!1,this.$timeout(function(){t.showPosition=!0},50)},p),templateUrl:"position_tile/PositionTile.html"};function p(t,e,i,o,n){var l=s.call(this)||this;return l.$timeout=e,l.$element=i,l.pipTileConfigDialogService=o,l.pipLocationEditDialog=n,l.showPosition=!0,l.options.menu.push({title:"Configurate",action:function(){l.onConfigClick()}}),l.options.menu.push({title:"Change location",action:function(){l.openLocationEditDialog()}}),l.options.location=l.options.location||l.options.position,t.$watch("$ctrl.options.location",function(){l.reDrawPosition()}),t.$watch(function(){return i.is(":visible")},function(t){1==t&&l.reDrawPosition()}),l}l.$inject=["pipDashboardProvider"],angular.module("pipDashboard").config(l)},{"../common_tile/DashboardTile":4}],21:[function(t,e,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});function l(t){t.registerTileType(a)}var s,r=t("../common_tile/DashboardTile"),a={name:"statistics",class:"pip-statistics-tile",controllerAs:"$ctrl",controller:(s=r.DashboardTile,n(p,s),p.prototype.changeSize=function(t){var e=this;this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.reset=!0,this.setChartSize(),this._$timeout(function(){e.reset=!1},500)},p.prototype.setChartSize=function(){this.chartSize=2==this.options.size.colSpan&&2==this.options.size.rowSpan?250:70},p),templateUrl:"statistics_tile/StatisticsTile.html"};function p(t,e){var i=s.call(this)||this;return i.reset=!1,i.chartSize=70,i._$scope=t,i._$timeout=e,i.options&&(i.menu=i.options.menu?_.union(i.menu,i.options.menu):i.menu),i.setChartSize(),i}l.$inject=["pipDashboardProvider"],angular.module("pipDashboard").config(l)},{"../common_tile/DashboardTile":4}],22:[function(t,e,i){function n(o,t,e,n){var l=document.createDocumentFragment();o.$eval(e.pipDraggableTiles).forEach(function(t){var e,i=(e=t.getCompiledTemplate(),n($("<div>").addClass("pip-draggable-tile").attr("pip-drag","true").attr("pip-scroll-container","'.pip-dashboard-scroll'").get(0))(o).append(e).get(0));l.appendChild(i)}),t.append(l)}function o(o){return{restrict:"A",link:function(t,e,i){new n(t,e,i,o)}}}o.$inject=["$compile"],angular.module("pipDraggableTilesGroup").directive("pipDraggableTiles",o)},{}],23:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ITilesGridConstructor=function(t,e,i,o,n){return new t(e,i,o,n)};var n=(o.prototype.addTile=function(t){return this.tiles.push(t),1===this.tiles.length&&this.generateGrid(),this},o.prototype.getCellByPosition=function(t,e){return this.gridCells[t][e]},o.prototype.getCells=function(t,e,i){return console.log("prevCell",t),this.isMobileLayout?this.getAvailableCellsMobile(t,e,i):this.getAvailableCellsDesktop(t,e,i)},o.prototype.getAvailableCellsDesktop=function(t,e,i){var o,n,l=t&&t.col||0,s=this.getBasicRow(t);if(1===i&&1===e){var r=this.gridCells.slice();if(t){if(!(o=this.getCell(r,s,l,this.columns))){var a=this.isMobileLayout?1:2;o=this.getCell(r,s+a,0,this.columns)}}else o=r[0][0]}if(2===i&&1===e){var p=t&&t.elem.size||null;p?2===p.colSpan&&2===p.rowSpan?n=0<this.columns-l-2?(o=this.getCellByPosition(s,l+1),this.getCellByPosition(s,l+2)):(o=this.getCellByPosition(s+2,0),this.getCellByPosition(s+2,1)):2===p.colSpan&&1===p.rowSpan?n=t.row%2==0?(o=this.getCellByPosition(s+1,l-1),this.getCellByPosition(s+1,l)):0<=this.columns-l-3?(o=this.getCellByPosition(s,l+1),this.getCellByPosition(s,l+2)):(o=this.getCellByPosition(s+2,0),this.getCellByPosition(s+2,1)):1===p.colSpan&&1===p.rowSpan&&(n=0<=this.columns-l-3?this.isCellFree(s,l+1)?(o=this.getCellByPosition(s,l+1),this.getCellByPosition(s,l+2)):(o=this.getCellByPosition(s,l+2),this.getCellByPosition(s,l+3)):(o=this.getCellByPosition(s+2,0),this.getCellByPosition(s+2,1))):(o=this.getCellByPosition(s,l),n=this.getCellByPosition(s,l+1))}return t||2!==e||2!==i?2===e&&2===i&&(n=0<this.columns-l-2?this.isCellFree(s,l+1)?(o=this.getCellByPosition(s,l+1),this.getCellByPosition(s+1,l+2)):(o=this.getCellByPosition(s,l+2),this.getCellByPosition(s+1,l+3)):(o=this.getCellByPosition(s+2,0),this.getCellByPosition(s+3,1))):(o=this.getCellByPosition(s,l),n=this.getCellByPosition(s+1,l+1)),{start:o,end:n}},o.prototype.getCell=function(t,e,i,o){var n,l,s;if(this.isMobileLayout){for(l=i;l<o;l++)if(!t[e][l].elem){n=t[e][l];break}return n}for(l=i;l<o;l++){for(s=0;s<2;s++)if(!t[s+e][l].elem){n=t[s+e][l];break}if(n)return n}},o.prototype.getAvailableCellsMobile=function(t,e,i){var o,n,l=this.getBasicRow(t),s=t&&t.col||0;if(1===i&&1===e){var r=this.gridCells.slice();if(t){if(!(o=this.getCell(r,l,s,this.columns))){var a=this.isMobileLayout?1:2;o=this.getCell(r,l+a,0,this.columns)}}else o=r[0][0]}return t?2===i&&(o=this.getCellByPosition(l+1,0),n=this.getCellByPosition(l+e,1)):(o=this.getCellByPosition(l,0),n=this.getCellByPosition(l+e-1,1)),{start:o,end:n}},o.prototype.getBasicRow=function(t){return this.isMobileLayout?t&&t&&t.row||0:t?t.row%2==0?t.row:t.row-1:0},o.prototype.isCellFree=function(t,e){return!this.gridCells[t][e].elem},o.prototype.getCellIndex=function(i){var o,n=this;return this.gridCells.forEach(function(t,e){o=_.findIndex(n.gridCells[e],function(t){return t===i})}),-1!==o?o:0},o.prototype.reserveCells=function(e,i,o){this.gridCells.forEach(function(t){t.forEach(function(t){t.row>=e.row&&t.row<=i.row&&t.col>=e.col&&t.col<=i.col&&(t.elem=o)})})},o.prototype.clearElements=function(){this.gridCells.forEach(function(t){t.forEach(function(t){t.elem=null})})},o.prototype.setAvailableColumns=function(t){return this.isMobileLayout=2===t,this.columns=t,this},o.prototype.generateGrid=function(t){var o=this,i=t||this.opts.tileWidth,n=document.querySelector(".pip-draggable-group-title").getBoundingClientRect(),l=0,s=0,r=[];function a(t){Array.apply(null,Array(t)).forEach(function(){o.columns<l+1&&(s++,l=0,o.gridCells.push(r),r=[]);var t=s*o.opts.tileHeight+(s?s*o.opts.gutter:0)+n.height,e=l*i+(l?l*o.opts.gutter:0);r.push({top:t,left:e,bottom:t+o.opts.tileHeight,right:e+i,row:s,col:l}),l++})}return this.gridCells=[],this.tiles.forEach(function(t,e,i){a(t.getSize().colSpan),i.length===e+1&&(l<o.columns&&a(o.columns-l),2*o.tiles.length>o.gridCells.length&&Array.apply(null,Array(2*o.tiles.length-o.gridCells.length)).forEach(function(){a(o.columns)}))}),this},o.prototype.setTilesDimensions=function(r,a){var p,c=this,u=this;return r&&u.clearElements(),this.tiles.forEach(function(t){var e,i,o,n,l=t.getSize();if(t.updateElem(".pip-draggable-tile"),1===l.colSpan)e=p&&2===p.elem.size.colSpan&&1===p.elem.size.rowSpan?u.getCells(u.getCellByPosition(p.row,p.col-1),1,1).start:u.getCells(p,1,1).start,r||(i=e.right-e.left,o=e.bottom-e.top),p=e,u.reserveCells(e,e,t);else if(2===l.colSpan){if(e=(n=u.getCells(p,l.rowSpan,l.colSpan)).start,!r){var s=c.isMobileLayout?c.opts.gutter:0;i=n.end.right-n.start.left+s,o=n.end.bottom-n.start.top}p=n.end,u.reserveCells(n.start,n.end,t)}a!==t?(r||t.setSize(i,o),t.setPosition(e.left,e.top)):t.setPreviewPosition({left:e.left,top:e.top})}),this},o.prototype.calcContainerHeight=function(t){var e,i;return this.tiles.length?(e=_.maxBy(this.tiles,function(t){var e=t.getSize();return e.top+e.height}).getSize(),this.elem.style.height=e.top+e.height+"px",this.inline&&(i=_.maxBy(this.tiles,function(t){var e=t.getSize();return e.left+e.width}).getSize(),this.elem.style.width=i.left+i.width+"px")):t&&(this.elem.style.height=t+40+"px"),this},o.prototype.getTileByNode=function(e){var t=this.tiles.filter(function(t){return e===t.getElem()});return t.length?t[0]:null},o.prototype.getTileByCoordinates=function(i,o){return this.tiles.filter(function(t){var e=t.getSize();return t!==o&&e.left<=i.left&&i.left<=e.left+e.width&&e.top<=i.top&&i.top<=e.top+e.height})[0]||null},o.prototype.getTileIndex=function(t){return _.findIndex(this.tiles,t)},o.prototype.swapTiles=function(t,e){var i=_.findIndex(this.tiles,t),o=_.findIndex(this.tiles,e);return this.tiles.splice(i,1),this.tiles.splice(o,0,t),this},o.prototype.removeTile=function(o){var n;return this.tiles.forEach(function(t,e,i){if(t===o)return n=i.splice(e,1)[0],!1}),n},o.prototype.updateTileOptions=function(e){var t=_.findIndex(this.tiles,function(t){return t.getOptions()===e});return-1!==t&&(this.tiles[t].setOptions(e),!0)},o);function o(t,e,i,o){this.gridCells=[],this.inline=!1,this.tiles=t,this.opts=e,this.columns=i||0,this.elem=o,this.gridCells=[],this.inline=e.inline||!1,this.isMobileLayout=2===i}i.TilesGridService=n,angular.module("pipDraggableTilesGroup").service("pipTilesGrid",function(){return function(t,e,i,o){return new n(t,e,i,o)}})},{}],24:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipDraggableTilesGroup",[]),t("./TileGroupDirective"),t("./TileGroupService")},{"./TileGroupDirective":22,"./TileGroupService":23}],25:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function o(i){angular.module("pipDashboard").controller=function(t,e){return i.register(t,e),this}}var n=(r.prototype.registerTileType=function(t){var e,i;"string"!=typeof t.controller&&(e="pip"+t.name.substr(0,1).toUpperCase()+t.name.substr(1)+"Tile",angular.module("pipDashboard").controller(e,t.controller)),!t.templateUrl&&t.template&&(i="pip"+t.name.substr(0,1).toUpperCase()+t.name.substr(1)+"Tile.html"),this.tilesTypes.push({name:t.name,controller:e||t.controller,templateUrl:i||t.templateUrl,controllerAs:t.controllerAs,template:t.template,class:t.class})},r.prototype.$get=["$templateCache",function(t){return null==this._service&&(this._service=new l(this.tilesTypes,t)),this._service}],r),l=(s.prototype.putTemplates=function(){var e=this;_.each(this.tileTypes,function(t){t.template&&e.$templateCache.put(t.templateUrl,t.template)})},s.prototype.getTileTypes=function(){return this.tileTypes},s.prototype.getTypeByName=function(e){return _.find(this.tileTypes,function(t){return t.name===e})},s);function s(t,e){this.tileTypes=t,this.$templateCache=e,this.putTemplates()}function r(){this.tilesTypes=[]}o.$inject=["$controllerProvider"],angular.module("pipDashboard").config(o).provider("pipDashboard",n)},{}],26:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function o(n){return{restrict:"A",link:function(e,t,i){var o=n(i.pipImageLoad);t.bind("load",function(t){o(e,{$event:t})})}}}var n=(l.$inject=["$interpolate","$compile","$templateRequest"],l.prototype.getTemplate=function(t,e,i,o){var n,l=this,s=t.template,r=t.templateUrl;if(t.type){var a=(e?this._$interpolate(e):this._$interpolate(s))(t);return 1==o?i?this._$compile(a)(i):this._$compile(a):a}return s?i?this._$compile(s)(i):this._$compile(s):(r&&this._$templateRequest(r,!1).then(function(t){n=i?l._$compile(t)(i):l._$compile(t)}),n)},l.prototype.setImageMarginCSS=function(t,e){var i=t.width?t.width():t.clientWidth,o=t.height?t.height():t.clientHeight,n=(e[0]?e[0].naturalWidth:e.naturalWidth)||e.width,l=(e[0]?e[0].naturalHeight:e.naturalWidth)||e.height,s=0,r={};l/o<n/i?(s=-(n/l*o-i)/2,r["margin-left"]=s+"px",r.height=o+"px",r.width=n*o/l+"px",r["margin-top"]=""):(s=-(l/n*i-o)/2,r["margin-top"]=s+"px",r.height=l*i/n+"px",r.width=i+"px",r["margin-left"]=""),$(e).css(r)},l);function l(t,e,i){this._$interpolate=t,this._$compile=e,this._$templateRequest=i}o.$inject=["$parse"],angular.module("pipDashboard").service("pipTileTemplate",n).directive("pipImageLoad",o)},{}],27:[function(t,e,i){!function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("add_tile_dialog/AddTile.html",'<md-dialog class="pip-dialog pip-add-component-dialog"><md-dialog-content class="layout-column"><div class="theme-divider p16 flex-auto"><h3 class="hide-xs m0 bm16 theme-text-primary" hide-xs="">{{ \'DASHBOARD_ADD_TILE_DIALOG_TITLE\' | translate }}<md-input-container class="layout-row flex-auto m0 tm16"><md-select class="flex-auto m0 theme-text-primary" ng-model="dialogCtrl.activeGroupIndex" placeholder="{{ \'DASHBOARD_ADD_TILE_DIALOG_CREATE_NEW_GROUP\' | translate }}" aria-label="Group"><md-option ng-value="$index" ng-repeat="group in dialogCtrl.groups">{{ group }}</md-option></md-select></md-input-container></h3></div><div class="pip-body pip-scroll p0 flex-auto"><p class="md-body-1 theme-text-secondary m0 lp16 rp16">{{ \'DASHBOARD_ADD_TILE_DIALOG_USE_HOT_KEYS\' | translate }}</p><md-list ng-init="groupIndex = $index" ng-repeat="group in dialogCtrl.defaultTiles"><md-list-item class="layout-row pip-list-item lp16 rp16" ng-repeat="item in group"><div class="icon-holder flex-none"><md-icon md-svg-icon="icons:{{:: item.icon }}"></md-icon><div class="pip-badge theme-badge md-warn" ng-if="item.amount"><span>{{ item.amount }}</span></div></div><span class="flex-auto lm24 theme-text-primary">{{:: item.title }}</span><md-button class="md-icon-button flex-none" ng-click="dialogCtrl.encrease(groupIndex, $index)" aria-label="Encrease"><md-icon md-svg-icon="icons:plus-circle"></md-icon></md-button><md-button class="md-icon-button flex-none" ng-click="dialogCtrl.decrease(groupIndex, $index)" aria-label="Decrease"><md-icon md-svg-icon="icons:minus-circle"></md-icon></md-button></md-list-item><md-divider class="lm72 tm8 bm8" ng-if="groupIndex !== (dialogCtrl.defaultTiles.length - 1)"></md-divider></md-list></div></md-dialog-content><md-dialog-actions class="flex-none layout-align-end-center theme-divider divider-top theme-text-primary"><md-button ng-click="dialogCtrl.cancel()" aria-label="Cancel">{{ \'CANCEL\' | translate }}</md-button><md-button ng-click="dialogCtrl.add()" ng-disabled="dialogCtrl.totalTiless === 0" arial-label="Add">{{ \'ADD\' | translate }}</md-button></md-dialog-actions></md-dialog>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("common_tile/DynamicTile.html",'<pip-tile-menu pip-menu="$ctrl.options.menu" ng-if="!$ctrl.options.hideMenu"></pip-tile-menu><div class="pip-tile-content {{ $ctrl.color }} layout-column" ng-class="{ small: $ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1, medium: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1, big: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 2 }"><pip-specific-template></pip-specific-template></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("config_tile_dialog/ConfigDialog.html",'<md-dialog class="pip-dialog pip-tile-config-dialog {{ vm.params.dialogClass }}" width="400" md-theme="{{vm.theme}}"><pip-tile-config-extend-component class="layout-column" pip-dialog-scope="vm" pip-extension-url="vm.extensionUrl" pip-apply="vm.onApply(updatedData)"></pip-tile-config-extend-component></md-dialog>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("config_tile_dialog/ConfigDialogExtendComponent.html",'<h3 class="tm0 flex-none">{{ \'DASHBOARD_TILE_CONFIG_DIALOG_TITLE\' | translate }}</h3><div class="pip-body pip-scroll p16 bp0 flex-auto"><pip-extension-point></pip-extension-point><pip-toggle-buttons class="bm16" ng-if="!$ctrl.hideSizes" pip-buttons="$ctrl.sizes" ng-model="$ctrl.sizeId"></pip-toggle-buttons><pip-color-picker ng-if="!$ctrl.hideColors" pip-colors="$ctrl.colors" ng-model="$ctrl.color"></pip-color-picker></div><div class="pip-footer flex-none"><div><md-button class="md-accent" ng-click="$ctrl.onCancel()">{{ \'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-click="$ctrl.onApply()">{{ \'APPLY\' | translate }}</md-button></div></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("dashboard/Dashboard.html",'<md-button class="md-accent md-raised md-fab layout-column layout-align-center-center" aria-label="Add component" ng-click="$ctrl.addComponent()"><md-icon md-svg-icon="icons:plus" class="md-headline centered-add-icon"></md-icon></md-button><div class="pip-draggable-grid-holder"><pip-draggable-grid pip-tiles-templates="$ctrl.groupedWidgets" pip-tiles-context="$ctrl.widgetsContext" pip-draggable-grid="$ctrl.draggableGridOptions" pip-group-menu-actions="$ctrl.groupMenuActions"></pip-draggable-grid><md-progress-circular md-mode="indeterminate" class="progress-ring"></md-progress-circular></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("draggable/Draggable.html",'<div class="pip-draggable-holder"><div class="pip-draggable-group" pip-drop="true" pip-drop-success="$ctrl.onDropListener($index, $event)" pip-enter="$ctrl.onDropEnterListener($index, $event)" pip-leave="$ctrl.onDropLeaveListener($index, $event)" pip-deactive="$ctrl.onDropDeactivateListener($index, $event)" ng-repeat="group in $ctrl.groups" data-group-id="{{ $index }}" pip-draggable-tiles="group.source"><div class="pip-draggable-group-title layout-row layout-align-start-center"><div class="title-input-container" ng-click="$ctrl.onTitleClick(group, $event)"><input ng-if="group.editingName" ng-blur="$ctrl.onBlurTitleInput(group)" ng-keypress="$ctrl.onKyepressTitleInput(group, $event)" ng-model="group.title"><div class="text-overflow flex-none" ng-if="!group.editingName">{{ group.title }}</div></div><md-button class="md-icon-button flex-none layout-align-center-center" ng-show="group.editingName" ng-click="$ctrl.cancelEditing(group)" aria-label="Cancel"><md-icon md-svg-icon="icons:cross"></md-icon></md-button><md-menu class="flex-none layout-column" md-position-mode="target-right target" ng-show="!group.editingName"><md-button class="md-icon-button flex-none layout-align-center-center" ng-click="$mdOpenMenu(); groupId = $index" aria-label="Menu"><md-icon md-svg-icon="icons:dots"></md-icon></md-button><md-menu-content width="4"><md-menu-item ng-repeat="action in $ctrl.groupMenuActions"><md-button ng-click="action.callback(groupId)">{{ action.title }}</md-button></md-menu-item></md-menu-content></md-menu></div></div><div class="pip-draggable-group fict-group layout-align-center-center layout-column tm16" pip-drop="true" pip-drop-success="$ctrl.onDropToFictGroupListener($event)" pip-enter="$ctrl.onDropEnterListener(null, $event)" pip-leave="$ctrl.onDropLeaveListener(null, $event)" pip-deactive="$ctrl.onDropDeactivateListener(null, $event)"><div class="fict-group-text-container"><md-icon md-svg-icon="icons:plus"></md-icon>{{ \'DROP_TO_CREATE_NEW_GROUP\' | translate }}</div></div></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("event_tile/ConfigDialogExtension.html",'<div class="w-stretch"><md-input-container class="w-stretch bm0"><label>Title:</label> <input type="text" ng-model="$ctrl.title"></md-input-container>Date:<md-datepicker ng-model="$ctrl.date" class="w-stretch bm8"></md-datepicker><md-input-container class="w-stretch"><label>Description:</label> <textarea type="text" ng-model="$ctrl.text">\n    </textarea></md-input-container>Backdrop\'s opacity:<md-slider aria-label="opacity" type="number" min="0.1" max="0.9" step="0.01" ng-model="$ctrl.opacity" ng-change="$ctrl.onOpacitytest($ctrl.opacity)"></md-slider></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("event_tile/EventTile.html",'<img ng-if="$ctrl.options.image" ng-src="{{$ctrl.options.image}}" alt="{{$ctrl.options.title || $ctrl.options.name}}"><div class="text-backdrop" style="background-color: rgba(0, 0, 0, {{ $ctrl.opacity }})"><div class="tile-heading layout-row layout-align-start-center flex-none"><span class="tile-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span></div><div class="text-container flex-auto pip-scroll"><p class="date flex-none" ng-if="$ctrl.options.date">{{ $ctrl.options.date }}</p><p class="text flex-auto">{{ $ctrl.options.text || $ctrl.options.description }}</p></div></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("menu_tile/MenuTile.html",'<md-menu class="tile-menu" md-position-mode="target-right target"><md-button class="md-icon-button flex-none" ng-click="$mdOpenMenu()" aria-label="Menu"><md-icon md-svg-icon="icons:vdots"></md-icon></md-button><md-menu-content width="4"><md-menu-item ng-repeat="item in $ctrl.menu"><md-button ng-if="!item.submenu" ng-click="item.action(item, $index)">{{:: item.title }}</md-button><md-menu ng-if="item.submenu"><md-button ng-click="item.action(item, $index)">{{:: item.title }}</md-button><md-menu-content><md-menu-item ng-repeat="subitem in item.submenu"><md-button ng-click="subitem.action(item, $index)">{{:: subitem.title }}</md-button></md-menu-item></md-menu-content></md-menu></md-menu-item></md-menu-content></md-menu>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("note_tile/ConfigDialogExtension.html",'<div class="w-stretch"><md-input-container class="w-stretch bm0"><label>Title:</label> <input type="text" ng-model="$ctrl.title"></md-input-container><md-input-container class="w-stretch tm0"><label>Text:</label> <textarea type="text" ng-model="$ctrl.text">\n    </textarea></md-input-container></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("note_tile/NoteTile.html",'<div class="tile-heading layout-row layout-align-start-center flex-none" ng-if="$ctrl.options.title || $ctrl.options.name"><span class="tile-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span></div><div class="text-container flex-auto pip-scroll"><p>{{ $ctrl.options.text }}</p></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("picture_slider_tile/PictureSliderTile.html",'<div class="tile-heading layout-row layout-align-start-center flex-none"><span class="tile-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span></div><div class="slider-container"><div pip-image-slider="" pip-animation-type="\'fading\'" pip-animation-interval="$ctrl.animationInterval" ng-if="$ctrl.animationType == \'fading\'"><div class="pip-animation-block" ng-repeat="slide in $ctrl.options.slides"><img ng-src="{{ slide.image }}" alt="{{ slide.image }}" pip-image-load="$ctrl.onImageLoad($event)"><p class="slide-text" ng-if="slide.text">{{ slide.text }}</p></div></div><div pip-image-slider="" pip-animation-type="\'carousel\'" pip-animation-interval="$ctrl.animationInterval" ng-if="$ctrl.animationType == \'carousel\'"><div class="pip-animation-block" ng-repeat="slide in $ctrl.options.slides"><img ng-src="{{ slide.image }}" alt="{{ slide.image }}" pip-image-load="$ctrl.onImageLoad($event)"><p class="slide-text" ng-if="slide.text">{{ slide.text }}</p></div></div></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("position_tile/ConfigDialogExtension.html",'<div class="w-stretch"><md-input-container class="w-stretch bm0"><label>Location name:</label> <input type="text" ng-model="$ctrl.locationName"></md-input-container></div>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("position_tile/PositionTile.html",'<div class="tile-heading lp16 rp8 layout-row layout-align-end-center flex-none" ng-if="$ctrl.options.locationName"><span class="flex tile-title text-overflow">{{ $ctrl.options.locationName }}</span></div><pip-location-map class="flex" ng-if="$ctrl.showPosition" pip-stretch="true" pip-rebind="true" pip-location-pos="$ctrl.options.location"></pip-location-map>')}])}(),function(e){try{e=angular.module("pipDashboard.Templates")}catch(t){e=angular.module("pipDashboard.Templates",[])}e.run(["$templateCache",function(t){t.put("statistics_tile/StatisticsTile.html",'<div class="tile-heading layout-row layout-align-start-center flex-none"><span class="tile-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span></div><div class="flex-auto layout-row layout-align-center-center" ng-if="$ctrl.options.series && !$ctrl.reset"><pip-pie-chart pip-series="$ctrl.options.series" ng-if="!$ctrl.options.chartType || $ctrl.options.chartType == \'pie\'" pip-donut="true" pip-pie-size="$ctrl.chartSize" pip-show-total="true" pip-centered="true"></pip-pie-chart></div>')}])}()},{}]},{},[15,27])(27)});
//# sourceMappingURL=pip-webui-dashboard.min.js.map
